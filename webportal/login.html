<div class="portlet-body form">
    <form id="logins_form" class="form-horizontal" novalidate="novalidate">
        <div class="form-body">
            <div class="form-group">
                <label class="control-label col-md-3">手机号 <span class="required" aria-required="true">
                * </span>
                </label>
                <div class="col-md-8">
                    <div class="input-icon right">
                        <i class="fa"></i>
                        <input type="text" class="form-control" name="userPhone" id="phone" placeholder="请输入手机号">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-md-3">验证码 <span class="required" aria-required="true">
                * </span>
                </label>
                <div class="col-md-8">
                    <div class="input-icon input-group right">
                        <i class="fa"></i>
                        <input type="text" class="form-control" name="verifyCode" id="verifyCode" placeholder="请输入验证码">
                        <span class="input-group-btn">
                           <button class="btn btn-default get-code" type="button" id="getCode">获取验证码</button>
                           <button class="btn btn-default reset-code" type="button" id="resetCode" style="display:none;"><span id="code_second">60</span>秒后重发</button>
                        </span> 
                    </div>
                </div>
            </div>
        </div>
		<div class="form-group text-danger" id="alert_box" style="display:none;font-size:12px;text-align:center;margin-bottom:0px;">
			<span class="col-md-12"></span>
		</div>
        <div class="form-group" style="margin-bottom:2px;">
            <div class="form-actions fluid">
                <div class="col-md-offset-2 col-md-8">
                   <!--  <button type="submit" class="btn btn-primary btn-block btn-lg">登 录</button> -->
                   <button type="button" class="btn btn-primary btn-block btn-lg" id="logining">登 录</button>
                </div>
            </div>
        </div>
      <!--   <div class="form-group">
          <div class="col-md-offset-2 col-md-8 text-right">
              <a href="reset-password.html" target="_blank">找回密码</a>
          </div>
      </div> -->
    </form>
</div>
<!-- <script src="js/login.js"></script> -->
<script type="text/javascript">
var BASE_API_URL = "http://localhost/cargocn-cloud-server/";
/*获取验证码*/
var isPhone = 1;
$("#getCode").on("click",function(){
    checkPhone(); //验证手机号码
    if(isPhone){
        resetCode(); //倒计时
    }else{
        $('#phone').focus();
    }
});
function getCode(e){
    checkPhone(); //验证手机号码
    if(isPhone){
        resetCode(); //倒计时
    }else{
        $('#phone').focus();
    }
    
}
//验证手机号码
function checkPhone(){
    var phone = $('#phone').val();
    var pattern = /^1[0-9]{10}$/;
    isPhone = 1;
    if(phone == '') {
        alert('请输入手机号码');
        isPhone = 0;
        return;
    }
    if(!pattern.test(phone)){
        alert('请输入正确的手机号码');
        isPhone = 0;
        return;
    }
}
//倒计时
function resetCode(){
    $('#getCode').hide();
    $('#code_second').html('60');
    $('#resetCode').show();
    var second = 60;
    var timer = null;
    timer = setInterval(function(){
        second -= 1;
        if(second >0 ){
            $('#code_second').html(second);
        }else{
            clearInterval(timer);
            $('#getCode').show();
            $('#resetCode').hide();
        }
    },1000);
}


$("#getCode1").on("click",function(){
    //debugger;
    var userPhone = $("#userPhone").val();
    if(userPhone=="" || userPhone==null) return;
    $.ajax({
        url: BASE_API_URL + "/getUserLoginCode.do?userPhone=" + userPhone,
        type: "POST",
        dataType: "json",
        success: function(result) {
           console.log(result);
           if(result.code==100){
               
           }else{
              console.log("获取验证码成功！");
           }
        }
    });
})

$("#logining").on("click",function(){
    //var userPhone = $("#phone").val();
    checkPhone(); //验证手机号码
    var verifyCode = $("#verifyCode").val();
    if(verifyCode==""){
        alert('请输入验证码');
        isPhone = 0;
        return;
    };
    // $.ajax({
    //     url: BASE_API_URL + "/carfreerWebLogin.do",
    //     type: "POST",
    //     dataType: "json",
    //     data: $("#logins_form").serialize(),
    //     success: function(result) {
    //        //console.log(data);
    //        if(result.code==100){
    //           console.log("用户手机号：" + result.data.userTel);
    //           if(result.data.locked = false){ //正常的
    //               myCookie.add("userTel",result.data.userTel,{"expires":5});
    //               console.log("userTel=" + myCookie.get("userTel"));
    //           }else{ //true 未验证通过
                  
    //           }
    //        }else{

    //        }
    //     }
    // });
    myCookie.add("userTel","admin",{"expires":5});
    console.log("userTel=" + myCookie.get("userTel"));
    $("#pop_login_out").modal("hide");
})
</script>